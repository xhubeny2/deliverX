
generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource deliverex {
  provider = "postgresql"
  // url      = env("POSTGRES_PRISMA_URL")
  url = env("DATABASE_URL")
}

enum Delivery_Status {
  PENDING
  IN_TRANSIT
  DELIVERED
  FAILED
}

enum Run_Status {
  ACTIVE
  FINISHED
}

model Driver {
  id        String   @id @default(cuid())
  name      String
  car       String
  // Jeden ridic ma vic jizd - jeho stav se odviji od jizd - ma/nema = active/inactive, atd.
  runs      Run[]
}

model Run {
  id          String     @id @default(cuid())
  date        DateTime   @default(now())
  status      Run_Status     @default(ACTIVE) // ACTIVE, DELAYED, FINISHED
  // JÃ­zda patri jednomu ridici
  driverId    String
  driver      Driver     @relation(fields: [driverId], references: [id])
  // Jedna jizda ma vic zasilek
  deliveries  Delivery[]
}

model Delivery {
  id             String   @id @default(cuid())
  orderNumber    String
  recipientName  String
  address        String
  status         Delivery_Status   @default(PENDING) // PENDING, IN_TRANSIT, DELIVERED, FAILED
  createdAt      DateTime @default(now())
  updatedAt      DateTime? @updatedAt
  deliveryDate   DateTime
  // Zasilka patri do jedne jizdy (Run)
  // "Run" je volitelny, protoze zasilka muze byt na sklade a cekat na prirazeni
  runId          String?
  run            Run?     @relation(fields: [runId], references: [id])
  order          Int?
}
